---
---

<button id="cart-trigger" class="cart-icon" aria-label="Open Cart" style="display: none;">
  <div class="icon-wrapper">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="9" cy="21" r="1"></circle>
      <circle cx="20" cy="21" r="1"></circle>
      <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
    </svg>
    <span id="cart-count" class="cart-badge">0</span>
  </div>
</button>

<style>
  .cart-icon {
    background: none;
    border: none;
    cursor: pointer;
    color: #333;
    padding: 0.5rem;
    position: relative;
    transition: color 0.3s ease;
  }

  .cart-icon:hover {
    color: #40e0d0;
  }
  
  .icon-wrapper {
    position: relative;
    display: inline-block;
  }

  .cart-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: #662b5c;
    color: white;
    font-size: 0.7rem;
    font-weight: bold;
    min-width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2px;
  }
</style>

<script>
  import { cart } from '../lib/cart';

  const cartTrigger = document.getElementById('cart-trigger');
  const cartCount = document.getElementById('cart-count');

  function updateCartUI() {
    const count = cart.getCartCount();
    if (cartCount) cartCount.textContent = count.toString();
    
    // Show/Hide icon based on count
    if (cartTrigger) {
      if (count > 0) {
        cartTrigger.style.display = 'block';
      } else {
        cartTrigger.style.display = 'none';
      }
    }
  }

  // Initial check
  updateCartUI();

  // Listen for updates
  window.addEventListener('cart:changed', () => {
    updateCartUI();
  });

  // Toggle drawer
  cartTrigger?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('cart:toggle'));
  });
</script>
